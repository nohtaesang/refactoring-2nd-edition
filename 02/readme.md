### 81page

- 나는 소프트웨어를 개발할 때 목적이 '기능 추가'냐, 아니면 '리팩터링'이냐를 명확히 구분해 작업한다.
  켄트 벡은 이를 두 개의 모자에 비유했다.
  기능을 추가할 때는 '기능 추가' 모자를 쓴 다음 기존 코드는 절대 건드리지 않고 새 기능을 추가하기만 한다.
  진척도는 테스트를 추가해서 통과하는지 확인하는 방식으로 측정한다.
  반면 리팩터링할 때는 '리팩터링' 모자를 쓴 다음 기능 추가는 절대 하지 않기로 다짐한 뒤 오로지 코드 재구성에만 전념한다.
  테스트도 새로 만들지 않는다.
  부득이 인터페이스를 변경해야 할 때만 기존 테스트를 수정한다.
  소프트웨어를 개발하는 동안 나는 두 모자를 자주 바꿔쓴다.
  새 기능을 추가하다 보면 코드 구조를 바꿔야 작업하기 훨씬 쉽겠다는 생각이 들기도 하는데, 그러면 잠시 모자를 바꿔 쓰고 리팩터링 한다.
  코드 구조가 어느 정도 개선되면 다시 모자를 바꿔 쓰고 기능 추가를 이어간다.
  코드가 이해하기 어렵게 짜였다면 다시 모자를 쓰고 리팩터링한다.

### 82page

- 리팩터링하지 않으면 소프트웨어의 내부 설계가 썩기 쉽다.
  그러면 코드만 봐서는 설계를 파악하기 어려워진다.
  코드만으로 설계를 파악하기 어려워질수록 설계를 유지하기 어려워지고, 설계가 부패되는 속도는 더욱 빨라진다.
- 리팩터링하면 버그를 쉽게 찾을 수 있다.
  리팩터링하면 코드가 하는 일을 깊게 파악하게 되면서 새로 깨달은 것을 곧바로 코드에 반영하게 된다.
- 리팩터링하면 프로그래밍 속도를 높일 수 있다.

### 85page

- 언제 리팩터링해야 할까?

  1. 처음에는 그냥 한다.
  2. 비슷한 일을 두 번째로 하게 되면, 일단 계속 진행한다.
  3. 비슷한 일을 세 번째 하게 되면 리팩터링한다. (삼진 리팩터링)

- 리팩터링 하기 좋은 시점은 코드베이스에 기능을 새로 추가하기 직전이다.

### 89page

- 버전 관리 시스템에서 커밋과 기능 추가 커밋을 분리해야 한다는 조언을 들은 적이 있다.
  이렇게 할 때의 큰 장점은 두 가지 활동을 구분해서 별개로 검토하고 승인할 수 있다는 것이다.
  하지만 나는 이 견해에 완전히 동의하지는 않는다.
  리팩터링은 기능 추가와 밀접하게 엮인 경우가 너무나 많기 때문에 굳이 나누는 것은 시간 낭비일 수 있다.

- 예컨대 라이브러리를 교체할 때는 기존 것과 새 것 모두를 포용하는 추상 인터페이스부터 마련한다.
  기존 코드가 이 추상 인터페이스를 호출하도록 만들고 나면 라이브러리를 훨씬 쉽게 교체할 수 있다.

### 90page

- 나는 지저분한 코드를 발견해도 굳이 수정할 필요가 없다면 리팩터링하지 않는다.
  외부 API 다루듯 호출해서 쓰는 코드라면 지저분해도 그냥 둔다.
  내부 동작을 이해해야 할 시점에 리팩토링해야 효과를 제대로 볼 수 있다.
- 리팩터링하는 것보다 처음부터 새로 작성하는 게 쉬울 때도 리팩터링하지 않는다.

### 92page

- 하지만 내가 볼 때 사람들이 빠지기 쉬운 `가장 위험한 오류는 리팩터링을 '클린 코드'나 '바람직한 엔지니어링 습관'처럼 도덕적인 이유로 정당화 하는 것` 이다.
  리팩터링의 본질은 코드 베으스를 예쁘게 꾸미는 데 있지 않다.
  오로지 경제적인 이유로 하는 것이다.
  리팩터링은 개발 기간을 단축하고자 하는 것이다.
  기능 추가 시간을 줄이고, 버그 수정 시간을 줄여준다.
